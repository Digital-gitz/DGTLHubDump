<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04">
  <Obj RefId="0">
    <TN RefId="0">
      <T>Microsoft.PowerShell.Commands.PSRepositoryItemInfo</T>
      <T>System.Management.Automation.PSCustomObject</T>
      <T>System.Object</T>
    </TN>
    <MS>
      <S N="Name">winget-install</S>
      <S N="Version">5.0.7</S>
      <S N="Type">Script</S>
      <S N="Description">Downloads and installs the latest version of winget and its dependencies._x000A__x000A_This script is designed to be straightforward and easy to use, removing the hassle of manually downloading, installing, and configuring winget. This function should be run with administrative privileges.</S>
      <S N="Author">asheroto</S>
      <S N="CompanyName">asheroto</S>
      <Nil N="Copyright" />
      <DT N="PublishedDate">2025-03-16T15:35:01-04:00</DT>
      <Obj N="InstalledDate" RefId="1">
        <DT>2025-03-16T12:00:04.3699501-04:00</DT>
        <MS>
          <Obj N="DisplayHint" RefId="2">
            <TN RefId="1">
              <T>Microsoft.PowerShell.Commands.DisplayHintType</T>
              <T>System.Enum</T>
              <T>System.ValueType</T>
              <T>System.Object</T>
            </TN>
            <ToString>DateTime</ToString>
            <I32>2</I32>
          </Obj>
        </MS>
      </Obj>
      <Nil N="UpdatedDate" />
      <Nil N="LicenseUri" />
      <URI N="ProjectUri">https://github.com/asheroto/winget-install</URI>
      <Nil N="IconUri" />
      <Obj N="Tags" RefId="3">
        <TN RefId="2">
          <T>System.Object[]</T>
          <T>System.Array</T>
          <T>System.Object</T>
        </TN>
        <LST>
          <S>PowerShell</S>
          <S>Windows</S>
          <S>winget</S>
          <S>win</S>
          <S>get</S>
          <S>install</S>
          <S>installer</S>
          <S>fix</S>
          <S>script</S>
          <S>setup</S>
          <S>PSScript</S>
        </LST>
      </Obj>
      <Obj N="Includes" RefId="4">
        <TN RefId="3">
          <T>System.Collections.Hashtable</T>
          <T>System.Object</T>
        </TN>
        <DCT>
          <En>
            <S N="Key">Cmdlet</S>
            <Obj N="Value" RefId="5">
              <TNRef RefId="2" />
              <LST />
            </Obj>
          </En>
          <En>
            <S N="Key">Function</S>
            <Obj N="Value" RefId="6">
              <TNRef RefId="2" />
              <LST>
                <S>Get-OSInfo</S>
                <S>Get-GitHubRelease</S>
                <S>CheckForUpdate</S>
                <S>UpdateSelf</S>
                <S>Write-Section</S>
                <S>Get-WingetDownloadUrl</S>
                <S>Get-WingetStatus</S>
                <S>Handle-Error</S>
                <S>Get-CurrentProcess</S>
                <S>ExitWithDelay</S>
                <S>Import-GlobalVariable</S>
                <S>Test-AdminPrivileges</S>
                <S>New-TemporaryFile2</S>
                <S>Path-ExistsInEnvironment</S>
                <S>Add-ToEnvironmentPath</S>
                <S>Set-PathPermissions</S>
                <S>Test-VCRedistInstalled</S>
                <S>TryRemove</S>
                <S>Install-NuGetIfRequired</S>
              </LST>
            </Obj>
          </En>
          <En>
            <S N="Key">DscResource</S>
            <Ref N="Value" RefId="5" />
          </En>
          <En>
            <S N="Key">Command</S>
            <Obj N="Value" RefId="7">
              <TNRef RefId="2" />
              <LST>
                <S>Get-OSInfo</S>
                <S>Get-GitHubRelease</S>
                <S>CheckForUpdate</S>
                <S>UpdateSelf</S>
                <S>Write-Section</S>
                <S>Get-WingetDownloadUrl</S>
                <S>Get-WingetStatus</S>
                <S>Handle-Error</S>
                <S>Get-CurrentProcess</S>
                <S>ExitWithDelay</S>
                <S>Import-GlobalVariable</S>
                <S>Test-AdminPrivileges</S>
                <S>New-TemporaryFile2</S>
                <S>Path-ExistsInEnvironment</S>
                <S>Add-ToEnvironmentPath</S>
                <S>Set-PathPermissions</S>
                <S>Test-VCRedistInstalled</S>
                <S>TryRemove</S>
                <S>Install-NuGetIfRequired</S>
              </LST>
            </Obj>
          </En>
          <En>
            <S N="Key">Workflow</S>
            <Ref N="Value" RefId="5" />
          </En>
          <En>
            <S N="Key">RoleCapability</S>
            <Ref N="Value" RefId="5" />
          </En>
        </DCT>
      </Obj>
      <Nil N="PowerShellGetFormatVersion" />
      <S N="ReleaseNotes">[Version 0.0.1] - Initial Release._x000A_[Version 0.0.2] - Implemented function to get the latest version of winget and its license._x000A_[Version 0.0.3] - Signed file for PSGallery._x000A_[Version 0.0.4] - Changed URI to grab latest release instead of releases and preleases._x000A_[Version 0.0.5] - Updated version number of dependencies._x000A_[Version 1.0.0] - Major refactor code, see release notes for more information._x000A_[Version 1.0.1] - Fixed minor bug where version 2.8 was hardcoded in URL._x000A_[Version 1.0.2] - Hardcoded UI Xaml version 2.8.4 as a failsafe in case the API fails. Added CheckForUpdates, Version, Help functions. Various bug fixes._x000A_[Version 1.0.3] - Added error message to catch block. Fixed bug where appx package was not being installed._x000A_[Version 1.0.4] - MisterZeus optimized code for readability._x000A_[Version 2.0.0] - Major refactor. Reverted to UI.Xaml 2.7.3 for stability. Adjusted script to fix install issues due to winget changes (thank you ChrisTitusTech). Added in all architecture support._x000A_[Version 2.0.1] - Renamed repo and URL references from winget-installer to winget-install. Added extra space after the last line of output._x000A_[Version 2.0.2] - Adjusted CheckForUpdates to include Install-Script instructions and extra spacing._x000A_[Version 2.1.0] - Added alternate method/URL for dependencies in case the main URL is down. Fixed licensing issue when winget is installed on Server 2022._x000A_[Version 2.1.1] - Switched primary/alternate methods. Added Cleanup function to avoid errors when cleaning up temp files. Added output of URL for alternate method. Suppressed Add-AppxProvisionedPackage output. Improved success message. Improved verbiage. Improve PS script comments. Added check if the URL is empty. Moved display of URL beneath the check._x000A_[Version 3.0.0] - Major changes. Added OS version detection checks - detects OS version, release ID, ensures compatibility. Forces older file installation for Server 2022 to avoid issues after installing. Added DebugMode, DisableCleanup, Force. Renamed CheckForUpdates to CheckForUpdate. Improved output. Improved error handling. Improved comments. Improved code readability. Moved CheckForUpdate into function. Added PowerShellGalleryName. Renamed Get-OSVersion to Get-OSInfo. Moved architecture detection into Get-OSInfo. Renamed Get-NewestLink to Get-WingetDownloadUrl. Have Get-WingetDownloadUrl not get preview releases._x000A_[Version 3.0.1] - Updated Get-OSInfo function to fix issues when used on non-English systems. Improved error handling of "resources in use" error._x000A_[Version 3.0.2] - Added winget registration command for Windows 10 machines._x000A_[Version 3.1.0] - Added support for one-line installation with irm and iex compatible with $Force session variable. Added UpdateSelf command to automatically update the script to the latest version. Created short URL asheroto.com/winget._x000A_[Version 3.1.1] - Changed winget register command to run on all OS versions._x000A_[Version 3.2.0] - Added -ForceClose logic to relaunch the script in conhost.exe and automatically end active processes associated with winget that could interfere with the installation. Improved verbiage on winget already installed._x000A_[Version 3.2.1] - Fixed minor glitch when using -Version or -Help parameters._x000A_[Version 3.2.2] - Improved script exit functionality._x000A_[Version 3.2.3] - Improved -ForceClose window handling with x86 PowerShell process._x000A_[Version 3.2.4] - Improved verbiage for incompatible systems. Added importing Appx module on Windows Server with PowerShell 7+ systems to avoid error message._x000A_[Version 3.2.5] - Removed pause after script completion. Added optional Wait parameter to force script to wait several seconds for script output._x000A_[Version 3.2.6] - Improved ExitWithDelay function. Sometimes PowerShell will close the window accidentally, even when using the proper 'exit' command. Adjusted several closures for improved readability. Improved error code checking. Fixed glitch with -Wait param._x000A_[Version 3.2.7] - Addded ability to install for all users. Added checks for Windows Sandbox and administrative privileges._x000A_[Version 4.0.0] - Microsoft created some short URLs for winget. Removed a large portion of the script to use short URLs instead. Simplified and refactored. Switched debug param from DebugMode to Debug._x000A_[Version 4.0.1] - Fixed PowerShell help information._x000A_[Version 4.0.2] - Adjusted UpdateSelf function to reset PSGallery to original state if it was not trusted. Improved comments._x000A_[Version 4.0.3] - Updated UI.Xaml package as per winget-cli issue #4208._x000A_[Version 4.0.4] - Fixed detection for Windows multi-session._x000A_[Version 4.0.5] - Improved error handling when registering winget._x000A_[Version 4.1.0] - Support for Windows Server 2019 added by installing Visual C++ Redistributable._x000A_[Version 4.1.1] - Minor revisions to comments &amp; debug output._x000A_[Version 4.1.2] - Implemented Visual C++ Redistributable version detection to ensure compatibility with winget._x000A_[Version 4.1.3] - Added additional debug output for Visual C++ Redistributable version detection._x000A_[Version 5.0.0] - Completely changed method to use winget-cli Repair-WingetPackageManager. Added environment path detection and addition if needed. Added NoExit parameter to prevent script from exiting after completion. Adjusted permissions of winget folder path for Server 2019. Improved exit handling to avoid PowerShell window closing._x000A_[Version 5.0.1] - Fixed typo in variable name._x000A_[Version 5.0.2] - Added detection of NuGet and PowerShell version to determine if package provider installation is needed._x000A_[Version 5.0.3] - Fixed missing argument in call to Add-ToEnvironmentPath._x000A_[Version 5.0.4] - Fixed bug with UpdateSelf function. Fixed bug when installing that may cause NuGet prompt to not be suppressed. Introduced Install-NuGetIfRequired function._x000A_[Version 5.0.5] - Fixed exit code issue. Fixes #52._x000A_[Version 5.0.6] - Fixed installation issue on Server 2022 by changing installation method to same as Server 2019. Fixes #62._x000A_[Version 5.0.7] - Added the literal %LOCALAPPDATA% path to the user environment PATH to prevent issues when usernames or user profile paths change, or when using non-Latin characters. Fixes #45. Added support to catch Get-CimInstance errors, lately occuring in Windows Sandbox. Removed Server 2022 changes introduced in version 5.0.6. Register winget command in all OS versions except Server 2019. Fixes #57.</S>
      <Obj N="Dependencies" RefId="8">
        <TNRef RefId="2" />
        <LST />
      </Obj>
      <S N="RepositorySourceLocation">https://www.powershellgallery.com/api/v2/items/psscript</S>
      <S N="Repository">PSGallery</S>
      <S N="PackageManagementProvider">NuGet</S>
      <Obj N="AdditionalMetadata" RefId="9">
        <TN RefId="4">
          <T>System.Management.Automation.PSCustomObject</T>
          <T>System.Object</T>
        </TN>
        <MS>
          <S N="description">Downloads and installs the latest version of winget and its dependencies._x000A__x000A_This script is designed to be straightforward and easy to use, removing the hassle of manually downloading, installing, and configuring winget. This function should be run with administrative privileges.</S>
          <S N="requireLicenseAcceptance">False</S>
          <S N="releaseNotes">[Version 0.0.1] - Initial Release._x000A_[Version 0.0.2] - Implemented function to get the latest version of winget and its license._x000A_[Version 0.0.3] - Signed file for PSGallery._x000A_[Version 0.0.4] - Changed URI to grab latest release instead of releases and preleases._x000A_[Version 0.0.5] - Updated version number of dependencies._x000A_[Version 1.0.0] - Major refactor code, see release notes for more information._x000A_[Version 1.0.1] - Fixed minor bug where version 2.8 was hardcoded in URL._x000A_[Version 1.0.2] - Hardcoded UI Xaml version 2.8.4 as a failsafe in case the API fails. Added CheckForUpdates, Version, Help functions. Various bug fixes._x000A_[Version 1.0.3] - Added error message to catch block. Fixed bug where appx package was not being installed._x000A_[Version 1.0.4] - MisterZeus optimized code for readability._x000A_[Version 2.0.0] - Major refactor. Reverted to UI.Xaml 2.7.3 for stability. Adjusted script to fix install issues due to winget changes (thank you ChrisTitusTech). Added in all architecture support._x000A_[Version 2.0.1] - Renamed repo and URL references from winget-installer to winget-install. Added extra space after the last line of output._x000A_[Version 2.0.2] - Adjusted CheckForUpdates to include Install-Script instructions and extra spacing._x000A_[Version 2.1.0] - Added alternate method/URL for dependencies in case the main URL is down. Fixed licensing issue when winget is installed on Server 2022._x000A_[Version 2.1.1] - Switched primary/alternate methods. Added Cleanup function to avoid errors when cleaning up temp files. Added output of URL for alternate method. Suppressed Add-AppxProvisionedPackage output. Improved success message. Improved verbiage. Improve PS script comments. Added check if the URL is empty. Moved display of URL beneath the check._x000A_[Version 3.0.0] - Major changes. Added OS version detection checks - detects OS version, release ID, ensures compatibility. Forces older file installation for Server 2022 to avoid issues after installing. Added DebugMode, DisableCleanup, Force. Renamed CheckForUpdates to CheckForUpdate. Improved output. Improved error handling. Improved comments. Improved code readability. Moved CheckForUpdate into function. Added PowerShellGalleryName. Renamed Get-OSVersion to Get-OSInfo. Moved architecture detection into Get-OSInfo. Renamed Get-NewestLink to Get-WingetDownloadUrl. Have Get-WingetDownloadUrl not get preview releases._x000A_[Version 3.0.1] - Updated Get-OSInfo function to fix issues when used on non-English systems. Improved error handling of "resources in use" error._x000A_[Version 3.0.2] - Added winget registration command for Windows 10 machines._x000A_[Version 3.1.0] - Added support for one-line installation with irm and iex compatible with $Force session variable. Added UpdateSelf command to automatically update the script to the latest version. Created short URL asheroto.com/winget._x000A_[Version 3.1.1] - Changed winget register command to run on all OS versions._x000A_[Version 3.2.0] - Added -ForceClose logic to relaunch the script in conhost.exe and automatically end active processes associated with winget that could interfere with the installation. Improved verbiage on winget already installed._x000A_[Version 3.2.1] - Fixed minor glitch when using -Version or -Help parameters._x000A_[Version 3.2.2] - Improved script exit functionality._x000A_[Version 3.2.3] - Improved -ForceClose window handling with x86 PowerShell process._x000A_[Version 3.2.4] - Improved verbiage for incompatible systems. Added importing Appx module on Windows Server with PowerShell 7+ systems to avoid error message._x000A_[Version 3.2.5] - Removed pause after script completion. Added optional Wait parameter to force script to wait several seconds for script output._x000A_[Version 3.2.6] - Improved ExitWithDelay function. Sometimes PowerShell will close the window accidentally, even when using the proper 'exit' command. Adjusted several closures for improved readability. Improved error code checking. Fixed glitch with -Wait param._x000A_[Version 3.2.7] - Addded ability to install for all users. Added checks for Windows Sandbox and administrative privileges._x000A_[Version 4.0.0] - Microsoft created some short URLs for winget. Removed a large portion of the script to use short URLs instead. Simplified and refactored. Switched debug param from DebugMode to Debug._x000A_[Version 4.0.1] - Fixed PowerShell help information._x000A_[Version 4.0.2] - Adjusted UpdateSelf function to reset PSGallery to original state if it was not trusted. Improved comments._x000A_[Version 4.0.3] - Updated UI.Xaml package as per winget-cli issue #4208._x000A_[Version 4.0.4] - Fixed detection for Windows multi-session._x000A_[Version 4.0.5] - Improved error handling when registering winget._x000A_[Version 4.1.0] - Support for Windows Server 2019 added by installing Visual C++ Redistributable._x000A_[Version 4.1.1] - Minor revisions to comments &amp; debug output._x000A_[Version 4.1.2] - Implemented Visual C++ Redistributable version detection to ensure compatibility with winget._x000A_[Version 4.1.3] - Added additional debug output for Visual C++ Redistributable version detection._x000A_[Version 5.0.0] - Completely changed method to use winget-cli Repair-WingetPackageManager. Added environment path detection and addition if needed. Added NoExit parameter to prevent script from exiting after completion. Adjusted permissions of winget folder path for Server 2019. Improved exit handling to avoid PowerShell window closing._x000A_[Version 5.0.1] - Fixed typo in variable name._x000A_[Version 5.0.2] - Added detection of NuGet and PowerShell version to determine if package provider installation is needed._x000A_[Version 5.0.3] - Fixed missing argument in call to Add-ToEnvironmentPath._x000A_[Version 5.0.4] - Fixed bug with UpdateSelf function. Fixed bug when installing that may cause NuGet prompt to not be suppressed. Introduced Install-NuGetIfRequired function._x000A_[Version 5.0.5] - Fixed exit code issue. Fixes #52._x000A_[Version 5.0.6] - Fixed installation issue on Server 2022 by changing installation method to same as Server 2019. Fixes #62._x000A_[Version 5.0.7] - Added the literal %LOCALAPPDATA% path to the user environment PATH to prevent issues when usernames or user profile paths change, or when using non-Latin characters. Fixes #45. Added support to catch Get-CimInstance errors, lately occuring in Windows Sandbox. Removed Server 2022 changes introduced in version 5.0.6. Register winget command in all OS versions except Server 2019. Fixes #57.</S>
          <S N="isLatestVersion">True</S>
          <S N="isAbsoluteLatestVersion">True</S>
          <S N="versionDownloadCount">21</S>
          <S N="downloadCount">1247027</S>
          <S N="packageSize">27495</S>
          <S N="published">3/16/2025 3:35:01 PM -04:00</S>
          <S N="created">3/16/2025 3:35:01 PM -04:00</S>
          <S N="lastUpdated">3/16/2025 4:00:00 PM -04:00</S>
          <S N="tags">PowerShell Windows winget win get install installer fix script setup PSScript PSFunction_Get-OSInfo PSCommand_Get-OSInfo PSFunction_Get-GitHubRelease PSCommand_Get-GitHubRelease PSFunction_CheckForUpdate PSCommand_CheckForUpdate PSFunction_UpdateSelf PSCommand_UpdateSelf PSFunction_Write-Section PSCommand_Write-Section PSFunction_Get-WingetDownloadUrl PSCommand_Get-WingetDownloadUrl PSFunction_Get-WingetStatus PSCommand_Get-WingetStatus PSFunction_Handle-Error PSCommand_Handle-Error PSFunction_Get-CurrentProcess PSCommand_Get-CurrentProcess PSFunction_ExitWithDelay PSCommand_ExitWithDelay PSFunction_Import-GlobalVariable PSCommand_Import-GlobalVariable PSFunction_Test-AdminPrivileges PSCommand_Test-AdminPrivileges PSFunction_New-TemporaryFile2 PSCommand_New-TemporaryFile2 PSFunction_Path-ExistsInEnvironment PSCommand_Path-ExistsInEnvironment PSFunction_Add-ToEnvironmentPath PSCommand_Add-ToEnvironmentPath PSFunction_Set-PathPermissions PSCommand_Set-PathPermissions PSFunction_Test-VCRedistInstalled PSCommand_Test-VCRedistInstalled PSFunction_TryRemove PSCommand_TryRemove PSFunction_Install-NuGetIfRequired PSCommand_Install-NuGetIfRequired PSIncludes_Function</S>
          <S N="developmentDependency">False</S>
          <S N="updated">2025-03-16T16:00:00Z</S>
          <S N="NormalizedVersion">5.0.7</S>
          <S N="Authors">asheroto</S>
          <S N="IsPrerelease">false</S>
          <S N="ItemType">Script</S>
          <S N="FileList">winget-install.nuspec|winget-install.ps1</S>
          <S N="GUID">3b581edb-5d90-4fa1-ba15-4f2377275463</S>
          <S N="CompanyName">asheroto</S>
        </MS>
      </Obj>
      <S N="InstalledLocation">C:\Users\Digital_Russkiy\Documents\PowerShell\Scripts</S>
    </MS>
  </Obj>
</Objs>
